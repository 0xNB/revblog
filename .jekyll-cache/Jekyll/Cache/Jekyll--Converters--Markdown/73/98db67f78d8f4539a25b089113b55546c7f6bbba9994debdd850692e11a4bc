I"≈
<p>Valve Anti Cheat is an userland Anti Cheat made to scan and detect external cheats (other processes) or internal cheats (in game processes).</p>

<p>As it is a userland level anticheat tool that means that it usually runs within the process that its meant to protect. It also can only monitor other user-land software whilst kernel level cheats can not be detected from user land.</p>

<p>VAC-Anti-Cheat thus can not detect hardware cheats (unless they are visible from userland) or kernel-land cheats (only enumerate list of drivers, check names and signatures and lower the trust factor sent to Valve if you allow unsigned drivers).</p>

<p>There are two different parts of VAC to consider:</p>

<ul>
  <li>VAC the Anti-Cheat made by Valve for a lot of different games</li>
  <li>Custom VAC modules that can be applied for specific games like Call of Duty or CSGO.</li>
</ul>

<p>Both are delivered as modules (executables), each time a VAC protected game is launched. They are downloaded and executed to check for specific ‚Äúcheat‚Äù patterns.</p>

<p>NOTE: Some games themselves include Anti-Cheat behaviors like CSGO, however those Anti-Cheat behaviours are developed by the same people as VAC so considered also as a part of Valve-Anti-Cheat.</p>

<h1 id="module-loading"><a href="#header-1"></a>Module Loading</h1>

<p>After reading up on work done by other people like <a href="r0da">https://whereisr0da.github.io/blog/posts/2021-03-10-quick-vac/</a> we can narrow our hunt for Valve Anti Cheat down to <code class="language-plaintext highlighter-rouge">steamservice.dll</code> which could be used in <code class="language-plaintext highlighter-rouge">SteamService.exe</code> or in <code class="language-plaintext highlighter-rouge">steam.exe</code>, if Steam is executed with administrator rights.</p>

<h2 id="steamservicedll"><a href="#header-2"></a>steamservice.dll</h2>

<p>The <code class="language-plaintext highlighter-rouge">steamservice.dll</code> found in <code class="language-plaintext highlighter-rouge">bin/</code> is a 32bit executable that holds the ValveAntiCheat core module.</p>

<p>Interestingly meta data also hasn‚Äôt been removed from the file leaking some of Valves internal build architecture. Following was leaked by <code class="language-plaintext highlighter-rouge">exiftool</code>: Full build address of the internal builder <code class="language-plaintext highlighter-rouge">buildbot_steam-relclient-win32-builder_steam_rel_client_win32@steam-relclient-win32-builder</code>)<code class="language-plaintext highlighter-rouge">.
From the pdb information we also get that Steam was build with a Windows PC from pdb path: 
</code>c:\buildslave\steam_rel_client_win32\build\bin\ClientRelease\bin\steamservice.pdb`.</p>
:ET